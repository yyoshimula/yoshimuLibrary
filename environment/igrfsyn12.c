#include <math.h>          /* maths functions */
#include "igrfsyn12.h"
#include "mex.h"

void igrf12syn(double date, double alt, double nlat, double elong, double *b){

	/****************************************************************************/
	// INPUT
	//   isv   = 0 if main-field values are required
	//   	     1 if secular variation values are required
	//   date  = year A.D. Must be greater than or equal to 1900.0 and 
	//           less than or equal to 2025.0.
	//   itype = 1 if geodetic (spheroid)
	//           2 if geocentric (sphere)
	//   alt   = height in km above sea level if itype = 1
	//         = distance from centre of Earth in km if itype = 2 (>3485 km)
	//           double
	//   colat = colatitude (0-180) double
	//   elong = east-longitude (0-360) double
	/****************************************************************************/
	// OUTPUT
	//   x     = north component (nT) if isv = 0, nT/year if isv = 1
	//   y     = east component (nT) if isv = 0, nT/year if isv = 1
	//   z     = vertical component (nT) if isv = 0, nT/year if isv = 1
	//   f     = total intensity (nT) if isv = 0, rubbish if isv = 1
	/****************************************************************************/

	// set initail values

	double gh[3450]={-31543.000, -2298.000, 5922.000, -677.000, 2905.000, -1061.000, 924.000, 1121.000, 1022.000, -1469.000, -330.000, 1256.000, 3.000, 572.000, 523.000, 876.000, 628.000, 195.000, 660.000, -69.000, -361.000, -210.000, 134.000, -75.000, -184.000, 328.000, -210.000, 264.000, 53.000, 5.000, -33.000, -86.000, -124.000, -16.000, 3.000, 63.000, 61.000, -9.000, -11.000, 83.000, -217.000, 2.000, -58.000, -35.000, 59.000, 36.000, -90.000, -69.000, 70.000, -55.000, -45.000, 0.000, -13.000, 34.000, -10.000, -41.000, -1.000, -21.000, 28.000, 18.000, -12.000, 6.000, -22.000, 11.000, 8.000, 8.000, -4.000, -14.000, -9.000, 7.000, 1.000, -13.000, 2.000, 5.000, -9.000, 16.000, 5.000, -5.000, 8.000, -18.000, 8.000, 10.000, -20.000, 1.000, 14.000, -11.000, 5.000, 12.000, -3.000, 1.000, -2.000, -2.000, 8.000, 2.000, 10.000, -1.000, -2.000, -1.000, 2.000, -3.000, -4.000, 2.000, 2.000, 1.000, -5.000, 2.000, -2.000, 6.000, 6.000, -4.000, 4.000, 0.000, 0.000, -2.000, 2.000, 4.000, 2.000, 0.000, 0.000, -6.000, -31464.000, -2298.000, 5909.000, -728.000, 2928.000, -1086.000, 1041.000, 1065.000, 1037.000, -1494.000, -357.000, 1239.000, 34.000, 635.000, 480.000, 880.000, 643.000, 203.000, 653.000, -77.000, -380.000, -201.000, 146.000, -65.000, -192.000, 328.000, -193.000, 259.000, 56.000, -1.000, -32.000, -93.000, -125.000, -26.000, 11.000, 62.000, 60.000, -7.000, -11.000, 86.000, -221.000, 4.000, -57.000, -32.000, 57.000, 32.000, -92.000, -67.000, 70.000, -54.000, -46.000, 0.000, -14.000, 33.000, -11.000, -41.000, 0.000, -20.000, 28.000, 18.000, -12.000, 6.000, -22.000, 11.000, 8.000, 8.000, -4.000, -15.000, -9.000, 7.000, 1.000, -13.000, 2.000, 5.000, -8.000, 16.000, 5.000, -5.000, 8.000, -18.000, 8.000, 10.000, -20.000, 1.000, 14.000, -11.000, 5.000, 12.000, -3.000, 1.000, -2.000, -2.000, 8.000, 2.000, 10.000, 0.000, -2.000, -1.000, 2.000, -3.000, -4.000, 2.000, 2.000, 1.000, -5.000, 2.000, -2.000, 6.000, 6.000, -4.000, 4.000, 0.000, 0.000, -2.000, 2.000, 4.000, 2.000, 0.000, 0.000, -6.000, -31354.000, -2297.000, 5898.000, -769.000, 2948.000, -1128.000, 1176.000, 1000.000, 1058.000, -1524.000, -389.000, 1223.000, 62.000, 705.000, 425.000, 884.000, 660.000, 211.000, 644.000, -90.000, -400.000, -189.000, 160.000, -55.000, -201.000, 327.000, -172.000, 253.000, 57.000, -9.000, -33.000, -102.000, -126.000, -38.000, 21.000, 62.000, 58.000, -5.000, -11.000, 89.000, -224.000, 5.000, -54.000, -29.000, 54.000, 28.000, -95.000, -65.000, 71.000, -54.000, -47.000, 1.000, -14.000, 32.000, -12.000, -40.000, 1.000, -19.000, 28.000, 18.000, -13.000, 6.000, -22.000, 11.000, 8.000, 8.000, -4.000, -15.000, -9.000, 6.000, 1.000, -13.000, 2.000, 5.000, -8.000, 16.000, 5.000, -5.000, 8.000, -18.000, 8.000, 10.000, -20.000, 1.000, 14.000, -11.000, 5.000, 12.000, -3.000, 1.000, -2.000, -2.000, 8.000, 2.000, 10.000, 0.000, -2.000, -1.000, 2.000, -3.000, -4.000, 2.000, 2.000, 1.000, -5.000, 2.000, -2.000, 6.000, 6.000, -4.000, 4.000, 0.000, 0.000, -2.000, 2.000, 4.000, 2.000, 0.000, 0.000, -6.000, -31212.000, -2306.000, 5875.000, -802.000, 2956.000, -1191.000, 1309.000, 917.000, 1084.000, -1559.000, -421.000, 1212.000, 84.000, 778.000, 360.000, 887.000, 678.000, 218.000, 631.000, -109.000, -416.000, -173.000, 178.000, -51.000, -211.000, 327.000, -148.000, 245.000, 58.000, -16.000, -34.000, -111.000, -126.000, -51.000, 32.000, 61.000, 57.000, -2.000, -10.000, 93.000, -228.000, 8.000, -51.000, -26.000, 49.000, 23.000, -98.000, -62.000, 72.000, -54.000, -48.000, 2.000, -14.000, 31.000, -12.000, -38.000, 2.000, -18.000, 28.000, 19.000, -15.000, 6.000, -22.000, 11.000, 8.000, 8.000, -4.000, -15.000, -9.000, 6.000, 2.000, -13.000, 3.000, 5.000, -8.000, 16.000, 6.000, -5.000, 8.000, -18.000, 8.000, 10.000, -20.000, 1.000, 14.000, -11.000, 5.000, 12.000, -3.000, 1.000, -2.000, -2.000, 8.000, 2.000, 10.000, 0.000, -2.000, -1.000, 2.000, -3.000, -4.000, 2.000, 2.000, 1.000, -5.000, 2.000, -2.000, 6.000, 6.000, -4.000, 4.000, 0.000, 0.000, -2.000, 1.000, 4.000, 2.000, 0.000, 0.000, -6.000, -31060.000, -2317.000, 5845.000, -839.000, 2959.000, -1259.000, 1407.000, 823.000, 1111.000, -1600.000, -445.000, 1205.000, 103.000, 839.000, 293.000, 889.000, 695.000, 220.000, 616.000, -134.000, -424.000, -153.000, 199.000, -57.000, -221.000, 326.000, -122.000, 236.000, 58.000, -23.000, -38.000, -119.000, -125.000, -62.000, 43.000, 61.000, 55.000, 0.000, -10.000, 96.000, -233.000, 11.000, -46.000, -22.000, 44.000, 18.000, -101.000, -57.000, 73.000, -54.000, -49.000, 2.000, -14.000, 29.000, -13.000, -37.000, 4.000, -16.000, 28.000, 19.000, -16.000, 6.000, -22.000, 11.000, 7.000, 8.000, -3.000, -15.000, -9.000, 6.000, 2.000, -14.000, 4.000, 5.000, -7.000, 17.000, 6.000, -5.000, 8.000, -19.000, 8.000, 10.000, -20.000, 1.000, 14.000, -11.000, 5.000, 12.000, -3.000, 1.000, -2.000, -2.000, 9.000, 2.000, 10.000, 0.000, -2.000, -1.000, 2.000, -3.000, -4.000, 2.000, 2.000, 1.000, -5.000, 2.000, -2.000, 6.000, 6.000, -4.000, 4.000, 0.000, 0.000, -2.000, 1.000, 4.000, 3.000, 0.000, 0.000, -6.000, -30926.000, -2318.000, 5817.000, -893.000, 2969.000, -1334.000, 1471.000, 728.000, 1140.000, -1645.000, -462.000, 1202.000, 119.000, 881.000, 229.000, 891.000, 711.000, 216.000, 601.000, -163.000, -426.000, -130.000, 217.000, -70.000, -230.000, 326.000, -96.000, 226.000, 58.000, -28.000, -44.000, -125.000, -122.000, -69.000, 51.000, 61.000, 54.000, 3.000, -9.000, 99.000, -238.000, 14.000, -40.000, -18.000, 39.000, 13.000, -103.000, -52.000, 73.000, -54.000, -50.000, 3.000, -14.000, 27.000, -14.000, -35.000, 5.000, -14.000, 29.000, 19.000, -17.000, 6.000, -21.000, 11.000, 7.000, 8.000, -3.000, -15.000, -9.000, 6.000, 2.000, -14.000, 4.000, 5.000, -7.000, 17.000, 7.000, -5.000, 8.000, -19.000, 8.000, 10.000, -20.000, 1.000, 14.000, -11.000, 5.000, 12.000, -3.000, 1.000, -2.000, -2.000, 9.000, 2.000, 10.000, 0.000, -2.000, -1.000, 2.000, -3.000, -4.000, 2.000, 2.000, 1.000, -5.000, 2.000, -2.000, 6.000, 6.000, -4.000, 4.000, 0.000, 0.000, -2.000, 1.000, 4.000, 3.000, 0.000, 0.000, -6.000, -30805.000, -2316.000, 5808.000, -951.000, 2980.000, -1424.000, 1517.000, 644.000, 1172.000, -1692.000, -480.000, 1205.000, 133.000, 907.000, 166.000, 896.000, 727.000, 205.000, 584.000, -195.000, -422.000, -109.000, 234.000, -90.000, -237.000, 327.000, -72.000, 218.000, 60.000, -32.000, -53.000, -131.000, -118.000, -74.000, 58.000, 60.000, 53.000, 4.000, -9.000, 102.000, -242.000, 19.000, -32.000, -16.000, 32.000, 8.000, -104.000, -46.000, 74.000, -54.000, -51.000, 4.000, -15.000, 25.000, -14.000, -34.000, 6.000, -12.000, 29.000, 18.000, -18.000, 6.000, -20.000, 11.000, 7.000, 8.000, -3.000, -15.000, -9.000, 5.000, 2.000, -14.000, 5.000, 5.000, -6.000, 18.000, 8.000, -5.000, 8.000, -19.000, 8.000, 10.000, -20.000, 1.000, 14.000, -12.000, 5.000, 12.000, -3.000, 1.000, -2.000, -2.000, 9.000, 3.000, 10.000, 0.000, -2.000, -2.000, 2.000, -3.000, -4.000, 2.000, 2.000, 1.000, -5.000, 2.000, -2.000, 6.000, 6.000, -4.000, 4.000, 0.000, 0.000, -2.000, 1.000, 4.000, 3.000, 0.000, 0.000, -6.000, -30715.000, -2306.000, 5812.000, -1018.000, 2984.000, -1520.000, 1550.000, 586.000, 1206.000, -1740.000, -494.000, 1215.000, 146.000, 918.000, 101.000, 903.000, 744.000, 188.000, 565.000, -226.000, -415.000, -90.000, 249.000, -114.000, -241.000, 329.000, -51.000, 211.000, 64.000, -33.000, -64.000, -136.000, -115.000, -76.000, 64.000, 59.000, 53.000, 4.000, -8.000, 104.000, -246.000, 25.000, -25.000, -15.000, 25.000, 4.000, -106.000, -40.000, 74.000, -53.000, -52.000, 4.000, -17.000, 23.000, -14.000, -33.000, 7.000, -11.000, 29.000, 18.000, -19.000, 6.000, -19.000, 11.000, 7.000, 8.000, -3.000, -15.000, -9.000, 5.000, 1.000, -15.000, 6.000, 5.000, -6.000, 18.000, 8.000, -5.000, 7.000, -19.000, 8.000, 10.000, -20.000, 1.000, 15.000, -12.000, 5.000, 11.000, -3.000, 1.000, -3.000, -2.000, 9.000, 3.000, 11.000, 0.000, -2.000, -2.000, 2.000, -3.000, -4.000, 2.000, 2.000, 1.000, -5.000, 2.000, -2.000, 6.000, 6.000, -4.000, 4.000, 0.000, 0.000, -1.000, 2.000, 4.000, 3.000, 0.000, 0.000, -6.000, -30654.000, -2292.000, 5821.000, -1106.000, 2981.000, -1614.000, 1566.000, 528.000, 1240.000, -1790.000, -499.000, 1232.000, 163.000, 916.000, 43.000, 914.000, 762.000, 169.000, 550.000, -252.000, -405.000, -72.000, 265.000, -141.000, -241.000, 334.000, -33.000, 208.000, 71.000, -33.000, -75.000, -141.000, -113.000, -76.000, 69.000, 57.000, 54.000, 4.000, -7.000, 105.000, -249.000, 33.000, -18.000, -15.000, 18.000, 0.000, -107.000, -33.000, 74.000, -53.000, -52.000, 4.000, -18.000, 20.000, -14.000, -31.000, 7.000, -9.000, 29.000, 17.000, -20.000, 5.000, -19.000, 11.000, 7.000, 8.000, -3.000, -14.000, -10.000, 5.000, 1.000, -15.000, 6.000, 5.000, -5.000, 19.000, 9.000, -5.000, 7.000, -19.000, 8.000, 10.000, -21.000, 1.000, 15.000, -12.000, 5.000, 11.000, -3.000, 1.000, -3.000, -2.000, 9.000, 3.000, 11.000, 1.000, -2.000, -2.000, 2.000, -3.000, -4.000, 2.000, 2.000, 1.000, -5.000, 2.000, -2.000, 6.000, 6.000, -4.000, 4.000, 0.000, 0.000, -1.000, 2.000, 4.000, 3.000, 0.000, 0.000, -6.000, -30594.000, -2285.000, 5810.000, -1244.000, 2990.000, -1702.000, 1578.000, 477.000, 1282.000, -1834.000, -499.000, 1255.000, 186.000, 913.000, -11.000, 944.000, 776.000, 144.000, 544.000, -276.000, -421.000, -55.000, 304.000, -178.000, -253.000, 346.000, -12.000, 194.000, 95.000, -20.000, -67.000, -142.000, -119.000, -82.000, 82.000, 59.000, 57.000, 6.000, 6.000, 100.000, -246.000, 16.000, -25.000, -9.000, 21.000, -16.000, -104.000, -39.000, 70.000, -40.000, -45.000, 0.000, -18.000, 0.000, 2.000, -29.000, 6.000, -10.000, 28.000, 15.000, -17.000, 29.000, -22.000, 13.000, 7.000, 12.000, -8.000, -21.000, -5.000, -12.000, 9.000, -7.000, 7.000, 2.000, -10.000, 18.000, 7.000, 3.000, 2.000, -11.000, 5.000, -21.000, -27.000, 1.000, 17.000, -11.000, 29.000, 3.000, -9.000, 16.000, 4.000, -3.000, 9.000, -4.000, 6.000, -3.000, 1.000, -4.000, 8.000, -3.000, 11.000, 5.000, 1.000, 1.000, 2.000, -20.000, -5.000, -1.000, -1.000, -6.000, 8.000, 6.000, -1.000, -4.000, -3.000, -2.000, 5.000, 0.000, -2.000, -2.000, -30554.000, -2250.000, 5815.000, -1341.000, 2998.000, -1810.000, 1576.000, 381.000, 1297.000, -1889.000, -476.000, 1274.000, 206.000, 896.000, -46.000, 954.000, 792.000, 136.000, 528.000, -278.000, -408.000, -37.000, 303.000, -210.000, -240.000, 349.000, 3.000, 211.000, 103.000, -20.000, -87.000, -147.000, -122.000, -76.000, 80.000, 54.000, 57.000, -1.000, 4.000, 99.000, -247.000, 33.000, -16.000, -12.000, 12.000, -12.000, -105.000, -30.000, 65.000, -55.000, -35.000, 2.000, -17.000, 1.000, 0.000, -40.000, 10.000, -7.000, 36.000, 5.000, -18.000, 19.000, -16.000, 22.000, 15.000, 5.000, -4.000, -22.000, -1.000, 0.000, 11.000, -21.000, 15.000, -8.000, -13.000, 17.000, 5.000, -4.000, -1.000, -17.000, 3.000, -7.000, -24.000, -1.000, 19.000, -25.000, 12.000, 10.000, 2.000, 5.000, 2.000, -5.000, 8.000, -2.000, 8.000, 3.000, -11.000, 8.000, -7.000, -8.000, 4.000, 13.000, -1.000, -2.000, 13.000, -10.000, -4.000, 2.000, 4.000, -3.000, 12.000, 6.000, 3.000, -3.000, 2.000, 6.000, 10.000, 11.000, 3.000, 8.000, -30500.000, -2215.000, 5820.000, -1440.000, 3003.000, -1898.000, 1581.000, 291.000, 1302.000, -1944.000, -462.000, 1288.000, 216.000, 882.000, -83.000, 958.000, 796.000, 133.000, 510.000, -274.000, -397.000, -23.000, 290.000, -230.000, -229.000, 360.000, 15.000, 230.000, 110.000, -23.000, -98.000, -152.000, -121.000, -69.000, 78.000, 47.000, 57.000, -9.000, 3.000, 96.000, -247.000, 48.000, -8.000, -16.000, 7.000, -12.000, -107.000, -24.000, 65.000, -56.000, -50.000, 2.000, -24.000, 10.000, -4.000, -32.000, 8.000, -11.000, 28.000, 9.000, -20.000, 18.000, -18.000, 11.000, 9.000, 10.000, -6.000, -15.000, -14.000, 5.000, 6.000, -23.000, 10.000, 3.000, -7.000, 23.000, 6.000, -4.000, 9.000, -13.000, 4.000, 9.000, -11.000, -4.000, 12.000, -5.000, 7.000, 2.000, 6.000, 4.000, -2.000, 1.000, 10.000, 2.000, 7.000, 2.000, -6.000, 5.000, 5.000, -3.000, -5.000, -4.000, -1.000, 0.000, 2.000, -8.000, -3.000, -2.000, 7.000, -4.000, 4.000, 1.000, -2.000, -3.000, 6.000, 7.000, -2.000, -1.000, 0.000, -3.000, -30421.000, -2169.000, 5791.000, -1555.000, 3002.000, -1967.000, 1590.000, 206.000, 1302.000, -1992.000, -414.000, 1289.000, 224.000, 878.000, -130.000, 957.000, 800.000, 135.000, 504.000, -278.000, -394.000, 3.000, 269.000, -255.000, -222.000, 362.000, 16.000, 242.000, 125.000, -26.000, -117.000, -156.000, -114.000, -63.000, 81.000, 46.000, 58.000, -10.000, 1.000, 99.000, -237.000, 60.000, -1.000, -20.000, -2.000, -11.000, -113.000, -17.000, 67.000, -56.000, -55.000, 5.000, -28.000, 15.000, -6.000, -32.000, 7.000, -7.000, 23.000, 17.000, -18.000, 8.000, -17.000, 15.000, 6.000, 11.000, -4.000, -14.000, -11.000, 7.000, 2.000, -18.000, 10.000, 4.000, -5.000, 23.000, 10.000, 1.000, 8.000, -20.000, 4.000, 6.000, -18.000, 0.000, 12.000, -9.000, 2.000, 1.000, 0.000, 4.000, -3.000, -1.000, 9.000, -2.000, 8.000, 3.000, 0.000, -1.000, 5.000, 1.000, -3.000, 4.000, 4.000, 1.000, 0.000, 0.000, -1.000, 2.000, 4.000, -5.000, 6.000, 1.000, 1.000, -1.000, -1.000, 6.000, 2.000, 0.000, 0.000, -7.000, -30334.000, -2119.000, 5776.000, -1662.000, 2997.000, -2016.000, 1594.000, 114.000, 1297.000, -2038.000, -404.000, 1292.000, 240.000, 856.000, -165.000, 957.000, 804.000, 148.000, 479.000, -269.000, -390.000, 13.000, 252.000, -269.000, -219.000, 358.000, 19.000, 254.000, 128.000, -31.000, -126.000, -157.000, -97.000, -62.000, 81.000, 45.000, 61.000, -11.000, 8.000, 100.000, -228.000, 68.000, 4.000, -32.000, 1.000, -8.000, -111.000, -7.000, 75.000, -57.000, -61.000, 4.000, -27.000, 13.000, -2.000, -26.000, 6.000, -6.000, 26.000, 13.000, -23.000, 1.000, -12.000, 13.000, 5.000, 7.000, -4.000, -12.000, -14.000, 9.000, 0.000, -16.000, 8.000, 4.000, -1.000, 24.000, 11.000, -3.000, 4.000, -17.000, 8.000, 10.000, -22.000, 2.000, 15.000, -13.000, 7.000, 10.000, -4.000, -1.000, -5.000, -1.000, 10.000, 5.000, 10.000, 1.000, -4.000, -2.000, 1.000, -2.000, -3.000, 2.000, 2.000, 1.000, -5.000, 2.000, -2.000, 6.000, 4.000, -4.000, 4.000, 0.000, 0.000, -2.000, 2.000, 3.000, 2.000, 0.000, 0.000, -6.000, -30220.000, -2068.000, 5737.000, -1781.000, 3000.000, -2047.000, 1611.000, 25.000, 1287.000, -2091.000, -366.000, 1278.000, 251.000, 838.000, -196.000, 952.000, 800.000, 167.000, 461.000, -266.000, -395.000, 26.000, 234.000, -279.000, -216.000, 359.000, 26.000, 262.000, 139.000, -42.000, -139.000, -160.000, -91.000, -56.000, 83.000, 43.000, 64.000, -12.000, 15.000, 100.000, -212.000, 72.000, 2.000, -37.000, 3.000, -6.000, -112.000, 1.000, 72.000, -57.000, -70.000, 1.000, -27.000, 14.000, -4.000, -22.000, 8.000, -2.000, 23.000, 13.000, -23.000, -2.000, -11.000, 14.000, 6.000, 7.000, -2.000, -15.000, -13.000, 6.000, -3.000, -17.000, 5.000, 6.000, 0.000, 21.000, 11.000, -6.000, 3.000, -16.000, 8.000, 10.000, -21.000, 2.000, 16.000, -12.000, 6.000, 10.000, -4.000, -1.000, -5.000, 0.000, 10.000, 3.000, 11.000, 1.000, -2.000, -1.000, 1.000, -3.000, -3.000, 1.000, 2.000, 1.000, -5.000, 3.000, -1.000, 4.000, 6.000, -4.000, 4.000, 0.000, 1.000, -1.000, 0.000, 3.000, 3.000, 1.000, -1.000, -4.000, -30100.000, -2013.000, 5675.000, -1902.000, 3010.000, -2067.000, 1632.000, -68.000, 1276.000, -2144.000, -333.000, 1260.000, 262.000, 830.000, -223.000, 946.000, 791.000, 191.000, 438.000, -265.000, -405.000, 39.000, 216.000, -288.000, -218.000, 356.000, 31.000, 264.000, 148.000, -59.000, -152.000, -159.000, -83.000, -49.000, 88.000, 45.000, 66.000, -13.000, 28.000, 99.000, -198.000, 75.000, 1.000, -41.000, 6.000, -4.000, -111.000, 11.000, 71.000, -56.000, -77.000, 1.000, -26.000, 16.000, -5.000, -14.000, 10.000, 0.000, 22.000, 12.000, -23.000, -5.000, -12.000, 14.000, 6.000, 6.000, -1.000, -16.000, -12.000, 4.000, -8.000, -19.000, 4.000, 6.000, 0.000, 18.000, 10.000, -10.000, 1.000, -17.000, 7.000, 10.000, -21.000, 2.000, 16.000, -12.000, 7.000, 10.000, -4.000, -1.000, -5.000, -1.000, 10.000, 4.000, 11.000, 1.000, -3.000, -2.000, 1.000, -3.000, -3.000, 1.000, 2.000, 1.000, -5.000, 3.000, -2.000, 4.000, 5.000, -4.000, 4.000, -1.000, 1.000, -1.000, 0.000, 3.000, 3.000, 1.000, -1.000, -5.000, -29992.000, -1956.000, 5604.000, -1997.000, 3027.000, -2129.000, 1663.000, -200.000, 1281.000, -2180.000, -336.000, 1251.000, 271.000, 833.000, -252.000, 938.000, 782.000, 212.000, 398.000, -257.000, -419.000, 53.000, 199.000, -297.000, -218.000, 357.000, 46.000, 261.000, 150.000, -74.000, -151.000, -162.000, -78.000, -48.000, 92.000, 48.000, 66.000, -15.000, 42.000, 93.000, -192.000, 71.000, 4.000, -43.000, 14.000, -2.000, -108.000, 17.000, 72.000, -59.000, -82.000, 2.000, -27.000, 21.000, -5.000, -12.000, 16.000, 1.000, 18.000, 11.000, -23.000, -2.000, -10.000, 18.000, 6.000, 7.000, 0.000, -18.000, -11.000, 4.000, -7.000, -22.000, 4.000, 9.000, 3.000, 16.000, 6.000, -13.000, -1.000, -15.000, 5.000, 10.000, -21.000, 1.000, 16.000, -12.000, 9.000, 9.000, -5.000, -3.000, -6.000, -1.000, 9.000, 7.000, 10.000, 2.000, -6.000, -5.000, 2.000, -4.000, -4.000, 1.000, 2.000, 0.000, -5.000, 3.000, -2.000, 6.000, 5.000, -4.000, 3.000, 0.000, 1.000, -1.000, 2.000, 4.000, 3.000, 0.000, 0.000, -6.000, -29873.000, -1905.000, 5500.000, -2072.000, 3044.000, -2197.000, 1687.000, -306.000, 1296.000, -2208.000, -310.000, 1247.000, 284.000, 829.000, -297.000, 936.000, 780.000, 232.000, 361.000, -249.000, -424.000, 69.000, 170.000, -297.000, -214.000, 355.000, 47.000, 253.000, 150.000, -93.000, -154.000, -164.000, -75.000, -46.000, 95.000, 53.000, 65.000, -16.000, 51.000, 88.000, -185.000, 69.000, 4.000, -48.000, 16.000, -1.000, -102.000, 21.000, 74.000, -62.000, -83.000, 3.000, -27.000, 24.000, -2.000, -6.000, 20.000, 4.000, 17.000, 10.000, -23.000, 0.000, -7.000, 21.000, 6.000, 8.000, 0.000, -19.000, -11.000, 5.000, -9.000, -23.000, 4.000, 11.000, 4.000, 14.000, 4.000, -15.000, -4.000, -11.000, 5.000, 10.000, -21.000, 1.000, 15.000, -12.000, 9.000, 9.000, -6.000, -3.000, -6.000, -1.000, 9.000, 7.000, 9.000, 1.000, -7.000, -5.000, 2.000, -4.000, -4.000, 1.000, 3.000, 0.000, -5.000, 3.000, -2.000, 6.000, 5.000, -4.000, 3.000, 0.000, 1.000, -1.000, 2.000, 4.000, 3.000, 0.000, 0.000, -6.000, -29775.000, -1848.000, 5406.000, -2131.000, 3059.000, -2279.000, 1686.000, -373.000, 1314.000, -2239.000, -284.000, 1248.000, 293.000, 802.000, -352.000, 939.000, 780.000, 247.000, 325.000, -240.000, -423.000, 84.000, 141.000, -299.000, -214.000, 353.000, 46.000, 245.000, 154.000, -109.000, -153.000, -165.000, -69.000, -36.000, 97.000, 61.000, 65.000, -16.000, 59.000, 82.000, -178.000, 69.000, 3.000, -52.000, 18.000, 1.000, -96.000, 24.000, 77.000, -64.000, -80.000, 2.000, -26.000, 26.000, 0.000, -1.000, 21.000, 5.000, 17.000, 9.000, -23.000, 0.000, -4.000, 23.000, 5.000, 10.000, -1.000, -19.000, -10.000, 6.000, -12.000, -22.000, 3.000, 12.000, 4.000, 12.000, 2.000, -16.000, -6.000, -10.000, 4.000, 9.000, -20.000, 1.000, 15.000, -12.000, 11.000, 9.000, -7.000, -4.000, -7.000, -2.000, 9.000, 7.000, 8.000, 1.000, -7.000, -6.000, 2.000, -3.000, -4.000, 2.000, 2.000, 1.000, -5.000, 3.000, -2.000, 6.000, 4.000, -4.000, 3.000, 0.000, 1.000, -2.000, 3.000, 3.000, 3.000, -1.000, 0.000, -6.000, -29692.000, -1784.000, 5306.000, -2200.000, 3070.000, -2366.000, 1681.000, -413.000, 1335.000, -2267.000, -262.000, 1249.000, 302.000, 759.000, -427.000, 940.000, 780.000, 262.000, 290.000, -236.000, -418.000, 97.000, 122.000, -306.000, -214.000, 352.000, 46.000, 235.000, 165.000, -118.000, -143.000, -166.000, -55.000, -17.000, 107.000, 68.000, 67.000, -17.000, 68.000, 72.000, -170.000, 67.000, -1.000, -58.000, 19.000, 1.000, -93.000, 36.000, 77.000, -72.000, -69.000, 1.000, -25.000, 28.000, 4.000, 5.000, 24.000, 4.000, 17.000, 8.000, -24.000, -2.000, -6.000, 25.000, 6.000, 11.000, -6.000, -21.000, -9.000, 8.000, -14.000, -23.000, 9.000, 15.000, 6.000, 11.000, -5.000, -16.000, -7.000, -4.000, 4.000, 9.000, -20.000, 3.000, 15.000, -10.000, 12.000, 8.000, -6.000, -8.000, -8.000, -1.000, 8.000, 10.000, 5.000, -2.000, -8.000, -8.000, 3.000, -3.000, -6.000, 1.000, 2.000, 0.000, -4.000, 4.000, -1.000, 5.000, 4.000, -5.000, 2.000, -1.000, 2.000, -2.000, 5.000, 1.000, 1.000, -2.000, 0.000, -7.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, -29619.400, -1728.200, 5186.100, -2267.700, 3068.400, -2481.600, 1670.900, -458.000, 1339.600, -2288.000, -227.600, 1252.100, 293.400, 714.500, -491.100, 932.300, 786.800, 272.600, 250.000, -231.900, -403.000, 119.800, 111.300, -303.800, -218.800, 351.400, 43.800, 222.300, 171.900, -130.400, -133.100, -168.600, -39.300, -12.900, 106.300, 72.300, 68.200, -17.400, 74.200, 63.700, -160.900, 65.100, -5.900, -61.200, 16.900, 0.700, -90.400, 43.800, 79.000, -74.000, -64.600, 0.000, -24.200, 33.300, 6.200, 9.100, 24.000, 6.900, 14.800, 7.300, -25.400, -1.200, -5.800, 24.400, 6.600, 11.900, -9.200, -21.500, -7.900, 8.500, -16.600, -21.500, 9.100, 15.500, 7.000, 8.900, -7.900, -14.900, -7.000, -2.100, 5.000, 9.400, -19.700, 3.000, 13.400, -8.400, 12.500, 6.300, -6.200, -8.900, -8.400, -1.500, 8.400, 9.300, 3.800, -4.300, -8.200, -8.200, 4.800, -2.600, -6.000, 1.700, 1.700, 0.000, -3.100, 4.000, -0.500, 4.900, 3.700, -5.900, 1.000, -1.200, 2.000, -2.900, 4.200, 0.200, 0.300, -2.200, -1.100, -7.400, 2.700, -1.700, 0.100, -1.900, 1.300, 1.500, -0.900, -0.100, -2.600, 0.100, 0.900, -0.700, -0.700, 0.700, -2.800, 1.700, -0.900, 0.100, -1.200, 1.200, -1.900, 4.000, -0.900, -2.200, -0.300, -0.400, 0.200, 0.300, 0.900, 2.500, -0.200, -2.600, 0.900, 0.700, -0.500, 0.300, 0.300, 0.000, -0.300, 0.000, -0.400, 0.300, -0.100, -0.900, -0.200, -0.400, -0.400, 0.800, -0.200, -0.900, -0.900, 0.300, 0.200, 0.100, 1.800, -0.400, -0.400, 1.300, -1.000, -0.400, -0.100, 0.700, 0.700, -0.400, 0.300, 0.300, 0.600, -0.100, 0.300, 0.400, -0.200, 0.000, -0.500, 0.100, -0.900, -29554.630, -1669.050, 5077.990, -2337.240, 3047.690, -2594.500, 1657.760, -515.430, 1336.300, -2305.830, -198.860, 1246.390, 269.720, 672.510, -524.720, 920.550, 797.960, 282.070, 210.650, -225.230, -379.860, 145.150, 100.000, -305.360, -227.000, 354.410, 42.720, 208.950, 180.250, -136.540, -123.450, -168.050, -19.570, -13.550, 103.850, 73.600, 69.560, -20.330, 76.740, 54.750, -151.340, 63.630, -14.580, -63.530, 14.580, 0.240, -86.360, 50.940, 79.880, -74.460, -61.140, -1.650, -22.570, 38.730, 6.820, 12.300, 25.350, 9.370, 10.930, 5.420, -26.320, 1.940, -4.640, 24.800, 7.620, 11.200, -11.730, -20.880, -6.880, 9.830, -18.110, -19.710, 10.170, 16.220, 9.360, 7.610, -11.250, -12.760, -4.870, -0.060, 5.580, 9.760, -20.110, 3.580, 12.690, -6.940, 12.670, 5.010, -6.720, -10.760, -8.160, -1.250, 8.100, 8.760, 2.920, -6.660, -7.730, -9.220, 6.010, -2.170, -6.120, 2.190, 1.420, 0.100, -2.350, 4.460, -0.150, 4.760, 3.060, -6.580, 0.290, -1.010, 2.060, -3.470, 3.770, -0.860, -0.210, -2.310, -2.090, -7.930, 2.950, -1.600, 0.260, -1.880, 1.440, 1.440, -0.770, -0.310, -2.270, 0.290, 0.900, -0.790, -0.580, 0.530, -2.690, 1.800, -1.080, 0.160, -1.580, 0.960, -1.900, 3.990, -1.390, -2.150, -0.290, -0.550, 0.210, 0.230, 0.890, 2.380, -0.380, -2.630, 0.960, 0.610, -0.300, 0.400, 0.460, 0.010, -0.350, 0.020, -0.360, 0.280, 0.080, -0.870, -0.490, -0.340, -0.080, 0.880, -0.160, -0.880, -0.760, 0.300, 0.330, 0.280, 1.720, -0.430, -0.540, 1.180, -1.070, -0.370, -0.040, 0.750, 0.630, -0.260, 0.210, 0.350, 0.530, -0.050, 0.380, 0.410, -0.220, -0.100, -0.570, -0.180, -0.820, -29496.570, -1586.420, 4944.260, -2396.060, 3026.340, -2708.540, 1668.170, -575.730, 1339.850, -2326.540, -160.400, 1232.100, 251.750, 633.730, -537.030, 912.660, 808.970, 286.480, 166.580, -211.030, -356.830, 164.460, 89.400, -309.720, -230.870, 357.290, 44.580, 200.260, 189.010, -141.050, -118.060, -163.170, -0.010, -8.030, 101.040, 72.780, 68.690, -20.900, 75.920, 44.180, -141.400, 61.540, -22.830, -66.260, 13.100, 3.020, -78.090, 55.400, 80.440, -75.000, -57.800, -4.550, -21.200, 45.240, 6.540, 14.000, 24.960, 10.460, 7.030, 1.640, -27.610, 4.920, -3.280, 24.410, 8.210, 10.840, -14.500, -20.030, -5.590, 11.830, -19.340, -17.410, 11.610, 16.710, 10.850, 6.960, -14.050, -10.740, -3.540, 1.640, 5.500, 9.450, -20.540, 3.450, 11.510, -5.270, 12.750, 3.130, -7.140, -12.380, -7.420, -0.760, 7.970, 8.430, 2.140, -8.420, -6.080, -10.080, 7.010, -1.940, -6.240, 2.730, 0.890, -0.100, -1.070, 4.710, -0.160, 4.440, 2.450, -7.220, -0.330, -0.960, 2.130, -3.950, 3.090, -1.990, -1.030, -1.970, -2.800, -8.310, 3.050, -1.480, 0.130, -2.030, 1.670, 1.650, -0.660, -0.510, -1.760, 0.540, 0.850, -0.790, -0.390, 0.370, -2.510, 1.790, -1.270, 0.120, -2.110, 0.750, -1.940, 3.750, -1.860, -2.120, -0.210, -0.870, 0.300, 0.270, 1.040, 2.130, -0.630, -2.490, 0.950, 0.490, -0.110, 0.590, 0.520, 0.000, -0.390, 0.130, -0.370, 0.270, 0.210, -0.860, -0.770, -0.230, 0.040, 0.870, -0.090, -0.890, -0.870, 0.310, 0.300, 0.420, 1.660, -0.450, -0.590, 1.080, -1.140, -0.310, -0.070, 0.780, 0.540, -0.180, 0.100, 0.380, 0.490, 0.020, 0.440, 0.420, -0.250, -0.260, -0.530, -0.260, -0.790, -29442.000, -1501.000, 4797.100, -2445.100, 3012.900, -2845.600, 1676.700, -641.900, 1350.700, -2352.300, -115.300, 1225.600, 244.900, 582.000, -538.400, 907.600, 813.700, 283.300, 120.400, -188.700, -334.900, 180.900, 70.400, -329.500, -232.600, 360.100, 47.300, 192.400, 197.000, -140.900, -119.300, -157.500, 16.000, 4.100, 100.200, 70.000, 67.700, -20.800, 72.700, 33.200, -129.900, 58.900, -28.900, -66.700, 13.200, 7.300, -70.900, 62.600, 81.600, -76.100, -54.100, -6.800, -19.500, 51.800, 5.700, 15.000, 24.400, 9.400, 3.400, -2.800, -27.400, 6.800, -2.200, 24.200, 8.800, 10.100, -16.900, -18.300, -3.200, 13.300, -20.600, -14.600, 13.400, 16.200, 11.700, 5.700, -15.900, -9.100, -2.000, 2.100, 5.400, 8.800, -21.600, 3.100, 10.800, -3.300, 11.800, 0.700, -6.800, -13.300, -6.900, -0.100, 7.800, 8.700, 1.000, -9.100, -4.000, -10.500, 8.400, -1.900, -6.300, 3.200, 0.100, -0.400, 0.500, 4.600, -0.500, 4.400, 1.800, -7.900, -0.700, -0.600, 2.100, -4.200, 2.400, -2.800, -1.800, -1.200, -3.600, -8.700, 3.100, -1.500, -0.100, -2.300, 2.000, 2.000, -0.700, -0.800, -1.100, 0.600, 0.800, -0.700, -0.200, 0.200, -2.200, 1.700, -1.400, -0.200, -2.500, 0.400, -2.000, 3.500, -2.400, -1.900, -0.200, -1.100, 0.400, 0.400, 1.200, 1.900, -0.800, -2.200, 0.900, 0.300, 0.100, 0.700, 0.500, -0.100, -0.300, 0.300, -0.400, 0.200, 0.200, -0.900, -0.900, -0.100, 0.000, 0.700, 0.000, -0.900, -0.900, 0.400, 0.400, 0.500, 1.600, -0.500, -0.500, 1.000, -1.200, -0.200, -0.100, 0.800, 0.400, -0.100, -0.100, 0.300, 0.400, 0.100, 0.500, 0.500, -0.300, -0.400, -0.400, -0.300, -0.800, 10.300, 18.100, -26.600, -8.700, -3.300, -27.400, 2.100, -14.100, 3.400, -5.500, 8.200, -0.700, -0.400, -10.100, 1.800, -0.700, 0.200, -1.300, -9.100, 5.300, 4.100, 2.900, -4.300, -5.200, -0.200, 0.500, 0.600, -1.300, 1.700, -0.100, -1.200, 1.400, 3.400, 3.900, 0.000, -0.300, -0.100, 0.000, -0.700, -2.100, 2.100, -0.700, -1.200, 0.200, 0.300, 0.900, 1.600, 1.000, 0.300, -0.200, 0.800, -0.500, 0.400, 1.300, -0.200, 0.100, -0.300, -0.600, -0.600, -0.800, 0.100, 0.200, -0.200, 0.200, 0.000, -0.300, -0.600, 0.300, 0.500, 0.100, -0.200, 0.500, 0.400, -0.200, 0.100, -0.300, -0.400, 0.300, 0.300, 0.000 };

	int isv = 0;
	int itype = 1;

	double t;
	int ll;

	double one;
	double two;
	double three;

	int nmx;
	int kmx;
	int nc;
	int l;
	int m;
	int n;
	int k;
	int j;
	int fm;
	int fn;
	int gn;
	int gmm;
	int lm;
	int i;

	double r;
	double ct;
	double st;
	double cl[13] = {0,0,0,0,0,0,0,0,0,0,0,0,0};
	double sl[13] = { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
	double cd;
	double sd;

	double a2;
	double b2;

	double rho;

	double ratio;
	double rr;

	double p[105];
	double q[105];

	double tc;

	double x;
	double y;
	double z;

	double colat = 90.0 - nlat;

	x = 0.0;
	y = 0.0;
	z = 0.0;

	if (date < 2015){
		t = 0.2*(date - 1900.0);
		ll = floor(t);
		one = ll;
		t = t - one;

		//  SH models before 1995.0 are only to degree 10

		if (date < 1995.0){
			nmx = 10;
			nc = nmx*(nmx + 2);
			ll = nc*ll;
			kmx = (nmx + 1)*(nmx + 2) / 2;
		}
		else{
			nmx = 13;
			nc = nmx*(nmx + 2);
			ll = floor(0.2*(date - 1995.0));
			//
			//    19 is the number of SH models that extend to degree 10
			//
			ll = 120 * 19 + nc*ll;
			kmx = (nmx + 1)*(nmx + 2) / 2;
		}

		tc = 1.0 - t;

		if (isv == 1){
			tc = -0.2;
			t = 0.2;
		}
	}
	else {
		t = date - 2015.0;
		tc = 1.0;

		if (isv == 1){
			t = 1.0;
			tc = 0.0;
		}
		//
		//     pointer for last coefficient in pen-ultimate set of MF coefficients...
		//
		ll = 3060;
		nmx = 13;
		nc = nmx*(nmx + 2);
		kmx = (nmx + 1)*(nmx + 2) / 2;
	}

	r = alt;
	one = colat*0.017453292;
	ct = cos(one);
	st = sin(one);
	one = elong*0.017453292;
	cl[0] = cos(one);
	sl[0] = sin(one);

	cd = 1.0;
	sd = 0.0;
	l = 1;
	m = 1;
	n = 0;

	if (itype == 1){

		//     conversion from geodetic to geocentric coordinates 
		//    (using the WGS84 spheroid)

		a2 = 40680631.6;
		b2 = 40408296.0;
		one = a2*st*st;
		two = b2*ct*ct;
		three = one + two;
		rho = sqrt(three);
		r = sqrt(alt*(alt + 2.0*rho) + (a2*one + b2*two) / three);
		cd = (alt + rho) / r;
		sd = (a2 - b2) / rho*ct*st / r;
		one = ct;
		ct = ct*cd - st*sd;
		st = st*cd + one*sd;
	}

	ratio = 6371.2 / r;
	rr = ratio*ratio;
	//
	//     computation of Schmidt quasi-normal coefficients p and x(=q)
	//
	p[0] = 1.0;
	p[2] = st;
	q[0] = 0.0;
	q[2] = ct;

for (k = 2; k <= kmx; k++){
//		for (k = 2; k < kmx; k++){
		if (n < m){
			m = 0;
			n = n + 1;
			rr = rr*ratio;
			fn = n;
			gn = n - 1;
		}
		fm = m;

		if (m == n && k  != 3){
			one = sqrt(1.0 - 0.5 / fm);
			j = k - n - 1;
			p[k - 1] = one*st*p[j - 1];
			q[k - 1] = one*(st*q[j - 1] + ct*p[j - 1]);
			cl[m - 1] = cl[m - 2] * cl[0] - sl[m - 2] * sl[0];
			sl[m - 1] = sl[m - 2] * cl[0] + cl[m - 2] * sl[0];
		}

		if (m  != n && k  != 3){
			gmm = m*m;
			one = sqrt(fn*fn - gmm);
			two = sqrt(gn*gn - gmm) / one;
			three = (fn + gn) / one;
			i = k - n;
			j = i - n + 1;
			p[k - 1] = three*ct*p[i - 1] - two*p[j - 1];
			q[k - 1] = three*(ct*q[i - 1] - st*p[i - 1]) - two*q[j - 1];
		}
		//
		//     synthesis of x, y and z in geocentric coordinates
		//     
		lm = ll + l;
		one = (tc*gh[lm - 1] + t*gh[lm + nc - 1])*rr;

		if (m != 0){
			two = (tc*gh[lm] + t*gh[lm + nc])*rr;
			three = one*cl[m - 1] + two*sl[m - 1];
			x = x + three*q[k - 1];
			z = z - (fn + 1.0)*three*p[k - 1];;
			if (st != 0.0){
				y = y + (one*sl[m - 1] - two*cl[m - 1])*fm*p[k - 1] / st;
			}
			else {
				y = y + (one*sl[m - 1] - two*cl[m - 1])*q[k - 1] * ct;
			}
			l = l + 2;
		}
		else{
			x = x + one*q[k - 1];
			z = z - (fn + 1.0)*one*p[k - 1];
			l = l + 1;
		}
		m = m + 1;
	}
	//
	//     conversion to coordinate system specified by itype
	//
	one = x;
	x = x*cd + z*sd;
	z = z*cd - one*sd;

	b[0] = x;
	b[1] = y;
	b[2] = z;

}

/* The gateway function */
void mexFunction(int nlhs, mxArray *plhs[],
                 int nrhs, const mxArray *prhs[])
{
/* variable declarations here */
    double year;              /* input scalar */
    double alt;              /* input scalar */
    double lat;              /* input scalar */
    double lon;              /* input scalar */
    double *b;              /* output vector 3x1 */
    
        /* check for proper number of arguments */
    if(nrhs != 4) {
        mexErrMsgIdAndTxt("IGRF12:nrhs","Four inputs required.");
    }
    if(nlhs != 1) {
        mexErrMsgIdAndTxt("IGRF12:nlhs","One output required.");
    }

      /* make sure the input arguments are scalar */
    if( !mxIsDouble(prhs[0]) || 
         mxIsComplex(prhs[0]) ||
         mxGetNumberOfElements(prhs[0])!=1 ) {
        mexErrMsgIdAndTxt("IGRF12:nrhs","Input must be a scalar.");
    }
        if( !mxIsDouble(prhs[1]) || 
         mxIsComplex(prhs[1]) ||
         mxGetNumberOfElements(prhs[1])!=1 ) {
        mexErrMsgIdAndTxt("IGRF12:nrhs","Input must be a scalar.");
    }
        if( !mxIsDouble(prhs[2]) || 
         mxIsComplex(prhs[2]) ||
         mxGetNumberOfElements(prhs[2])!=1 ) {
        mexErrMsgIdAndTxt("IGRF12:nrhs","Input must be a scalar.");
    }
        if( !mxIsDouble(prhs[3]) || 
         mxIsComplex(prhs[3]) ||
         mxGetNumberOfElements(prhs[3])!=1 ) {
        mexErrMsgIdAndTxt("IGRF12:nrhs","Input must be a scalar.");
    }
    
    year = mxGetScalar(prhs[0]);
    alt  = mxGetScalar(prhs[1]);
    lat  = mxGetScalar(prhs[2]);
    lon  = mxGetScalar(prhs[3]);
    
    /* create the output matrix */
    plhs[0] = mxCreateDoubleMatrix(1, 3,mxREAL);
    
    /* get a pointer to the real data in the output matrix */
    b = mxGetPr(plhs[0]);
    

    /* call the computational routine */
    igrf12syn(year, alt, lat, lon, b);
  
}